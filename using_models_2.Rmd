---
title: "using_model2"
author: "Briantama Asmara"
date: "11/18/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


# Load the data
```{r}
require(palmerpenguins)
```

```{r}
t.test(subset(penguins, species == "Gentoo")$flipper_length_mm)
```

```{r}
t.test(x= subset(penguins,
                 species=="Gentoo")$flipper_length_mm,
       mu=218)
```

```{r}
t.test(x=subset(penguins, species == "Gentoo")$flipper_length_mm,
       mu = 218,
       alternative="less")
```

```{r}
t.test(
  x=subset(penguins, species=="Gentoo")$flipper_length_mm,
  mu=218,
  alternative = "less"
)
```

```{r}
t.test(flipper_length_mm ~ species, data = subset(penguins, species != "Chinstrap"))
```

```{r}
par(mfrow = c(1,2))
hist(penguins$body_mass_g, breaks = 80, main = "histogram of body mass", xlab = "body mass (g)")
plot(density(penguins$body_mass_g, na.rm = TRUE), main = "density plot of body mass")
```

```{r}
boxplot(body_mass_g ~ species, data=penguins)
```
```{r}
dat_chinstrap = subset(penguins, species == "Chinstrap")
mean(dat_chinstrap$body_mass_g, na.rm = TRUE)
```

```{r}
shapiro.test(dat_chinstrap$body_mass_g)
```

```{r}
aggregate(body_mass_g ~ species, data = penguins, FUN = function(x) shapiro.test(x)$p.value)
```

```{r}
fit_species = lm(body_mass_g ~ species, data = penguins)
```

```{r}
summary(fit_species)
```

```{r}
anova(fit_species)
```

```{r}
fit_species = lm(body_mass_g ~ species, data = penguins)
```

```{r}
summary(fit_species)
```

```{r}
anova(fit_species)
```

```{r}
boxplot(body_mass_g ~ species, data = penguins)
```

```{r}
fit_additive = lm(body_mass_g ~ sex + species, data = penguins)
```

```{r}
fit_additive = lm(body_mass_g ~ sex + species, data = penguins)
```

# Question 1 Re-create the conditional boxplot of penguin body mass conditioned on sex and species.



```{r}
boxplot(body_mass_g ~ sex + species, 
        data = penguins,
        xlab =  "Sex and Species",
        ylab = "Body Mass (g)",
        names = c("female\nAdelie", "male\nAdelie", "female\nChinstrap", "male\nChinstrap", "female\nGentoo", "male\nGentoo"))
```

# Q2 (2 pts.): Based on the boxplots, do you think male penguins (of any species) are significantly heavier than female penguins? Explain your reasoning.

# Q3 (2 pts.): Do you think adding sex to a model that already includes species will improve the model fit? Make sure you justify your answer based on the boxplots and not results of a statistical test.




